INFRA [root@hctjwqk8snginx01 conf.d]# kubectl -n lb describe cm/haproxy-conf
Name:         haproxy-conf
Namespace:    lb
Labels:       <none>
Annotations:  kubectl.kubernetes.io/last-applied-configuration={"apiVersion":"v1","data":{"haproxy.cfg":"#---------------------------------------------------------------------\n# Example configuration for a possibl...

Data
====
haproxy.cfg:
----
#---------------------------------------------------------------------
# Example configuration for a possible web application.  See the
# full configuration options online.
#
#   http://haproxy.1wt.eu/download/1.4/doc/configuration.txt
#
#---------------------------------------------------------------------

#---------------------------------------------------------------------
# Global settings
#---------------------------------------------------------------------
global
    # to have these messages end up in /var/log/haproxy.log you will
    # need to:
    #
    # 1) configure syslog to accept network log events.  This is done
    #    by adding the '-r' option to the SYSLOGD_OPTIONS in
    #    /etc/sysconfig/syslog
    #
    # 2) configure local2 events to go to the /var/log/haproxy.log
    #   file. A line like the following can be added to
    #   /etc/sysconfig/syslog
    #
    #    local2.*                       /var/log/haproxy.log
    #
    #log         127.0.0.1 local2
    log  /dev/log  local0 info

    maxconn     40000
    master-worker   no-exit-on-failure
    # turn on stats unix socket

#---------------------------------------------------------------------
# common defaults that all the 'listen' and 'backend' sections will
# use if not designated in their block
#---------------------------------------------------------------------
defaults
    mode                    tcp
    log                     global
    option                  tcplog
    option                  dontlognull
    option                  redispatch
    retries                 3
    timeout http-request    10s
    timeout queue           1m
    timeout connect         10s
    timeout client          1m
    timeout server          1m
    timeout http-keep-alive 10s
    timeout check           10s
    maxconn                 10000
    default-server          init-addr last,libc,none

listen uat-rabbitmq
    bind        0.0.0.0:5001
    mode        tcp
    balance     leastconn
    server      uat-rabbitmq-0      uat-rabbitmq-0.uat-rabbitmq.rabbitmq:5672 weight 1 check inter 3000 rise 1 fall 3
    server      uat-rabbitmq-1      uat-rabbitmq-1.uat-rabbitmq.rabbitmq:5672 weight 1 check inter 3000 rise 1 fall 3

listen uat-rabbitmq_admin
    bind        0.0.0.0:5002
    server      uat-rabbitmq-0      uat-rabbitmq-0.uat-rabbitmq.rabbitmq:15672 weight 1 check inter 3000 rise 1 fall 3
    server      uat-rabbitmq-1      uat-rabbitmq-1.uat-rabbitmq.rabbitmq:15672 weight 1 check inter 3000 rise 1 fall 3


listen sit-rabbitmq
    bind        0.0.0.0:5011
    mode        tcp
    balance     leastconn
    server      sit-rabbitmq-0      sit-rabbitmq-0.sit-rabbitmq.rabbitmq:5672 weight 1 check inter 3000 rise 1 fall 3
    server      sit-rabbitmq-1      sit-rabbitmq-1.sit-rabbitmq.rabbitmq:5672 weight 1 check inter 3000 rise 1 fall 3

listen sit-rabbitmq_admin
    bind        0.0.0.0:5012
    server      sit-rabbitmq-0      sit-rabbitmq-0.sit-rabbitmq.rabbitmq:15672 weight 1 check inter 3000 rise 1 fall 3
    server      sit-rabbitmq-1      sit-rabbitmq-1.sit-rabbitmq.rabbitmq:15672 weight 1 check inter 3000 rise 1 fall 3

listen online-rabbitmq
    bind        0.0.0.0:5021
    mode        tcp
    balance     leastconn
    server      online-rabbitmq-0      online-rabbitmq-0.online-rabbitmq.rabbitmq:5672 weight 1 check inter 3000 rise 1 fall 3
    server      online-rabbitmq-1      online-rabbitmq-1.online-rabbitmq.rabbitmq:5672 weight 1 check inter 3000 rise 1 fall 3

listen online-rabbitmq_admin
    bind        0.0.0.0:5022
    server      online-rabbitmq-0      online-rabbitmq-0.online-rabbitmq.rabbitmq:15672 weight 1 check inter 3000 rise 1 fall 3
    server      online-rabbitmq-1      online-rabbitmq-1.online-rabbitmq.rabbitmq:15672 weight 1 check inter 3000 rise 1 fall 3

listen k8s-rabbitmq04
    bind        0.0.0.0:5031
    mode        tcp
    balance     leastconn
    server      k8s-rabbitmq04-0      k8s-rabbitmq04-0.k8s-rabbitmq04.rabbitmq:5672 weight 1 check inter 3000 rise 1 fall 3
    server      k8s-rabbitmq04-1      k8s-rabbitmq04-1.k8s-rabbitmq04.rabbitmq:5672 weight 1 check inter 3000 rise 1 fall 3

listen k8s-rabbitmq04_admin
    bind        0.0.0.0:5032
    server      k8s-rabbitmq04-0      k8s-rabbitmq04-0.k8s-rabbitmq04.rabbitmq:15672 weight 1 check inter 3000 rise 1 fall 3
    server      k8s-rabbitmq04-1      k8s-rabbitmq04-1.k8s-rabbitmq04.rabbitmq:15672 weight 1 check inter 3000 rise 1 fall 3

listen k8s-rabbitmq05
    bind        0.0.0.0:5041
    mode        tcp
    balance     leastconn
    server      k8s-rabbitmq05-0      k8s-rabbitmq05-0.k8s-rabbitmq05.rabbitmq:5672 weight 1 check inter 3000 rise 1 fall 3
    server      k8s-rabbitmq05-1      k8s-rabbitmq05-1.k8s-rabbitmq05.rabbitmq:5672 weight 1 check inter 3000 rise 1 fall 3

listen k8s-rabbitmq05_admin
    bind        0.0.0.0:5042
    server      k8s-rabbitmq05-0      k8s-rabbitmq05-0.k8s-rabbitmq05.rabbitmq:15672 weight 1 check inter 3000 rise 1 fall 3
    server      k8s-rabbitmq05-1      k8s-rabbitmq05-1.k8s-rabbitmq05.rabbitmq:15672 weight 1 check inter 3000 rise 1 fall 3

listen admin_stats
    bind  0.0.0.0:5000
    stats enable
    mode http
    log global
    stats uri /stats
    stats realm Haproxy\ Statistics
    stats auth admin:admin
    #stats hide-version
    stats admin if TRUE
    stats refresh 30s

Events:  <none>
